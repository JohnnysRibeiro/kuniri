#!/usr/bin/env ruby

require 'kuniri'
require 'optparse'
require 'kuniri/core/kuniri'
require 'kuniri/language/container_data/structured_and_oo/class_data'
require 'kuniri/parser/parser_xml'

options = {}

OptionParser.new do |opts|
  opts.banner = "Usage: example.rb [options]"
  opts.version = Kuniri::VERSION

  opts.on("-v", "--[no-]verbose", "Run verbosely") do |v|
    options[:verbose] = v
  end

  opts.on("--version", "Show Kuniri version") do |v|
    puts opts.ver
    exit
  end

  opts.on("-i", "Iterative mode") do |v|
    puts "Iterative mode..."
    kuniri = Kuniri::Kuniri.new
    kuniri.run_analysis
    kuniri.start_navigation_mode
  end

  opts.on("-p", "Parse project") do |v|
    puts "PARSER..."
  end

  opts.on("--export", "Export XML") do |v|
    puts "Exporting XML..."
    kuniri = Kuniri::Kuniri.new
    kuniri.run_analysis

    path = 'export/class.xml'
    parser = Parser::XML.new
    parser.create_class_data kuniri.get_parser().fileLanguage[1].class_extract
    puts parser.get_builder.to_xml
  end

end.parse!

p options
p ARGV
